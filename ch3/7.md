### 8086CPU程序控制指令

程序控制指令又称为控制转移指令，包括：转移指令、循环控制指令、过程调用指令和中断指令 4 类。转移指令又分为无条件转移指令和条件转移指令。

##### 1.无条件转移指令 JMP

计算机程序的执行完全按照 CS:IP 的指向执行指令。通常情况下 CS 保持不变，IP 自动增量，程序就按照指令的先后顺序执行。无条件转移指令会修改 CS 和 IP 的值，使程序跳转到另一个位置去执行，改变指令的执行顺序。

根据程序的转移范围可分为段内转移和段间转移。在同一段的范围之内进行转移，只需要修改 IP 的值，称为段内转移。如果 CS 的值被修改，意味着程序将转移到另外的段去执行， 这称为段间转移。段间转移不仅修改段基址 CS 的值，还修改 IP 的值。

JMP 指令不影响标志位。

###### （1） 段内转移

指令格式：	JMP	OPRD

功能：段内转移，IP	IP+位移量，或给 IP 赋值。

说明：根据 OPRD 的类型又分为段内直接转移和段内间接转移。指令不影响标志位。

###### （2） 段间转移

指令格式：	JMP	OPRD

功能：段间转移，IP←OPRD 的段内偏移地址，CS←OPRD 所在段的段基址。

说明：根据 OPRD 的类型又分为段间直接转移和段间间接转移。指令不影响标志位。

##### 2.条件转移指令

条件转移指令先测试条件，若条件成立则执行转移操作；若不成立则不转移并顺序执行下一条指令。所有的条件转移指令转移范围-128~+127，属于段内短转移，都不影响状态标志位。

 

指令格式：	JCC	OPRD

功能：若条件成立则转移到 OPRD 处执行，IP	IP+位移量。

说明：J 是JUMP 的缩写，CC 表示转移的条件，OPRD 通常是标号。

######                                                                条件转移指令

| 指令名称         | 汇编格式       | 转移条件          | 功能说明           |
| ---------------- | -------------- | ----------------- | ------------------ |
| 进位转移         | JC target      | (CF)=1            | 有进位或借位       |
| 无进位转移       | JNC target     | (CF)=0            | 无进位或借位       |
| 等于或为零转移   | JE/JZ target   | (ZF)=1            | 相等或结果为 0     |
| 不等于或非零转移 | JNE/JNZ target | (ZF)=0            | 不相等或结果不为 0 |
| 奇偶校验为偶转移 | JP/JPE target  | (PF)=1            | 有偶数个 1         |
| 奇偶校验为奇转移 | JP/JPO target  | (PE)=0            | 有奇数个 1         |
| 结果为负转移     | JS target      | (SF)=1            | 为负数             |
| 结果为正转移     | JNS target     | (SF)=0            | 为正数             |
| 溢出转移         | JO target      | (OF)=1            | 溢出               |
| 不溢出转移       | JNO target     | (OF)=0            | 不溢出             |
| 大于则转移       | JA/JNBE target | (CF)=0 且(ZF)=0   | 无符号数           |
| 大于或等于则转移 | JAE/JNB target | (CF)=0            | 无符号数           |
| 小于则转移       | JB/JNAE target | (CF)=1            | 无符号数           |
| 小于或等于则转移 | JBE/JNA target | (CF)=1 或(ZF)=1   | 无符号数           |
| 大于则转移       | JG/JNLE target | (SF)=(OF)且(ZF)=0 | 带符号数           |
| 大于或等于则转移 | JGE/JNL target | (SF)=(OF)         | 带符号数           |
| 小于则转移       | JL/JNGE target | (SF)≠(OF)且(ZF)=0 | 带符号数           |
| 小于或等于则转移 | JLE/JNG target | (SF)≠(OF)或(ZF)=1 | 带符号数           |
| CX内容为0转移    | JCXZ target    | (CX)=0            |                    |

##### 3.过程调用指令

过程调用指令也称为子程序调用指令。程序设计时常常把一些功能相对完整或相对独立的程序段编写成独立的程序模块，称为子程序，子程序的应用使程序结构清晰明了。主程序可用调用指令调用子程序，子程序执行结束后自动返回主程序，主程序继续执行。

###### （1） 调用指令

根据子程序所在的位置，调用指令分为段内调用和段间调用。段内调用只修改 IP 的值， 段间调用 CS 和 IP 的值都被修改。CALL 指令在执行时第一步首先保存断点，以便子程序返回主程序时从断点处继续执行；第二步取出子程序的入口地址赋给 IP 或 CS：IP，转去执行子程序。

指令格式：CALL	OPRD

功能：调用 OPRD 指明的子程序。

说明：OPRD 可以是子程序的名字或指令标号，可以是 16 位的寄存器，还可以是两个或 4 个存储单元的内容。

###### （2） 返回指令

返回指令放在子程序的末尾，它能返回调用程序。返回指令的操作是弹出断点地址，送给 IP 和 CS。返回指令与 CALL 指令有关联，如果是段内调用，返回指令只弹出 IP 的值； 如果是段间调用，返回指令弹出 IP 和 CS 的值。虽然包含的操作不同，但返回指令的格式却一样。返回指令不影响标志位。

##### 4.中断指令

中断，是指在程序执行过程中，出现某种紧急事件，CPU 暂停执行现行程序，转去执行事件处理程序，执行完后再返回到被暂停的程序继续执行。引起中断的事件称为中断源， 计算机的中断源可能是某个硬件部件，也可能是软件，中断指令就是软件中断源之一。任何中断都是通过调用中断服务程序达到中断的目的。

软件中断通过中断指令调用中断服务程序（中断处理程序）。中断服务程序的入口地址称为中断向量。每个中断向量包含一组段基址和偏移地址，以 4 个字节的形式存放在中断向量表中。中断向量表位于内存 00000H～003FFH 区域，存放着 256 个中断向量。中断向量在中断向量表中存放地址由中断类型码乘以 4 得到。

微处理器有三种中断指令：INT、INTO、INT3。它们通过中断向量表获取中断服务程序的入口地址，然后执行中断服务程序。中断调用类似于子程序远调用，它们都把返回地址存放在堆栈中。这三种中断指令的执行过程如下：

① FLAGS 压栈

② 置 TF= 0，IF=0，禁止中断

③ CS 压栈

④ IP 压 栈

⑤ 查中断向量表，n×4 作为地址，从该地址中取出中断向量送CS:IP，CPU 执行中断服务程序。

###### （1） INT指令

指令格式：INT n

说明：n 为中断类型码，取值范围 0~255。INT 指令为 2 个字节，第一个字节是操作码， 第二个字节是中断类型码。中断指令执行时清除IF 和TF，使微处理器禁止可屏蔽中断请求，禁止单步执行中断服务程序。

###### （2） 中断返回指令

指令格式：IRET

功能：中断返回

说明：所有中断服务程序中的最后一条指令都是 IRET，它的具体操作如下：

① 弹出 IP

② 弹出CS

③ 弹出 FLAGS

中断返回指令恢复FLAGS，因而恢复了 IF 和 TF 的内容。

###### （3） INT3 指令

指令格式：INT3

说明：该指令用于在软件调试中设置断点，方便调试程序。INT3 指令是单字节指令， 其他软中断指令都是两字节指令。

###### （4） INTO指令

说明：INTO 为溢出中断，相当于 INT	4 指令。INTO 指令执行时检查OF 位，若 OF=1，则进入中断类型码为 4 的中断服务程序；若OF=0，则指令执行结束。

软中断指令通常用来调用系统过程，如控制打印机、视频显示器、磁盘驱动器等。中断指令的存在主要是因为计算机的某些功能需要利用特殊渠道实现，例如用户程序要想驱动计算机硬件，必须通过操作系统，而用户程序只能在用户态执行不能进入系统态，因此使用中断的方式调用操作系统相应的模块，这也称为系统功能调用。